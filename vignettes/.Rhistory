# load dependencies
.load_dependencies<- function(dependencies){
sapply(dependencies, require, character.only = TRUE)
return(dependencies)
}
.dependencies<-c("dplyr","ggplot2","ggthemes","reshape2","data.table","plyr","tidyr")
.install_dependencies(.dependencies)
.install_reachR(reinstall_if_exists = F)
.load_dependencies(c(.dependencies,"reachR"))
library("cleaninginspectoR")
data<-read.csv(file.choose(),header=TRUE,sep=";")
a<-inspect_all(data,uuid.column.name = "X_uuid")
kable(a)
a<-inspect_all(data,uuid.column.name = "X_uuid")
a<-find_duplicates(data,uuid.column.name = "X_uuid")
a<-find_duplicates(data,"X_uuid")
duplicate<-find_duplicates(data,"X_uuid")
outliers <- find_outliers(data,"X_uuid")
other_response <- find_other_responses(data)
kable(outliers)
kable(outliers[c(11,12),])
kable(outliers[c(11:154),])
kable(outliers[c(11,12, 69, 102),])
# install reachR
.install_reachR<-function(reinstall_if_exists = F){
if(!.is.package.installed("reachR") | reinstall_if_exists){
# get devtools if needed
if(!.is.package.installed("devtools")){install.packages("devtools")}
require("devtools")
install_github("mabafaba/reachR",ref = "master",force=T)
# unload devtools
detach("package:devtools", unload=TRUE)
if(reinstall_if_exists){
warning("Please restart R session to update reachR documentation")
}
}
}
.install_reachR(reinstall_if_exists = F)
knitr::opts_chunk$set(echo = TRUE)
library("cleaninginspectoR")
library("cleaninginspectoR")
data<-read.csv(file.choose(),header=TRUE,sep=",")
data<-read.csv(file.choose(),header=TRUE,sep=";")
all <- inspect_all(data)
data <- data.frame(data, indexx=1:nrow(data))
all <- inspect_all(data, "indexx")
outliers <- find_outliers(data , "indexx")
other_res <- find_other_responses(data)
knitr::opts_chunk$set(echo = TRUE)
who = "Martin"
# get your todo list
todolist<-todo_download(who)
library("researchcyclematrix")
rcm<- researchcyclematrix::rcm_download()
who = "Martin"
# get your todo list
todolist<-todo_download(who)
# get your todo list
todolist<-todo_download(.)
# get your todo list
todolist<-todo_download('.')
who = "Eliora"
# get your todo list
todolist<-todo_download(who)
who = "Martin"
# get your todo list
todolist<-todo_download(who)
who = "Sharon"
# get your todo list
todolist<-todo_download(who)
source('~/GitHub/visualisationIMPACT/R/barchart_functions.R')
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>"
)
library("visualisationIMPACT")
library(magrittr)
library("ggthemes")
library("rlang")
library(extrafont)
data<-read.csv("../tests/testthat/testdata.csv")
dependent.var = "hhnumberindividuals"
independent.var = "region"
result <- data %>% dplyr::select(c( independent.var , dependent.var)) %>% dplyr::group_by_(independent.var) %>% dplyr::summarise_all(c(average=mean,min=min,max=max))
regions.value=c("capitalcentral","capitalcentral", "north","north","south","south","west","west")
choices_value=c("yes","no","yes","no","yes","no","yes","no")
result_percent= c(0.5,0.50, 0.30, 0.70, 0.45,0.55, 0.90,0.10)
min_value <- result_percent-5
max_value <- result_percent+5
table_result <- data.frame(region=regions.value, choice=choices_value, percents=result_percent, infimum_error=min_value, supremum_error=max_value)
grouped_barchart_impact(table_result, region , choice , percents, infimum_error, supremum_error, sens.barchart="vertical", percent = TRUE, scale.percent = 100 )
source('~/GitHub/visualisationIMPACT/R/barchart_functions.R')
regions.value=c("capitalcentral","capitalcentral", "north","north","south","south","west","west")
choices_value=c("yes","no","yes","no","yes","no","yes","no")
result_percent= c(0.5,0.50, 0.30, 0.70, 0.45,0.55, 0.90,0.10)
min_value <- result_percent-5
max_value <- result_percent+5
table_result <- data.frame(region=regions.value, choice=choices_value, percents=result_percent, infimum_error=min_value, supremum_error=max_value)
grouped_barchart_impact(table_result, region , choice , percents, infimum_error, supremum_error, sens.barchart="vertical", percent = TRUE, scale.percent = 100 )
source('~/GitHub/visualisationIMPACT/R/barchart_functions.R')
regions.value=c("capitalcentral","capitalcentral", "north","north","south","south","west","west")
choices_value=c("yes","no","yes","no","yes","no","yes","no")
result_percent= c(0.5,0.50, 0.30, 0.70, 0.45,0.55, 0.90,0.10)
min_value <- result_percent-5
max_value <- result_percent+5
table_result <- data.frame(region=regions.value, choice=choices_value, percents=result_percent, infimum_error=min_value, supremum_error=max_value)
grouped_barchart_impact(table_result, region , choice , percents, infimum_error, supremum_error, sens.barchart="vertical", percent = TRUE, scale.percent = 100 )
library("visualisationIMPACT")
devtools::document()
setwd("~/GitHub/visualisationIMPACT")
devtools::document()
devtools::load_all()
devtools::build()
devtools::install()
library("visualisationIMPACT")
library(magrittr)
library("ggthemes")
library("rlang")
library(extrafont)
data<-read.csv("../tests/testthat/testdata.csv")
dependent.var = "hhnumberindividuals"
independent.var = "region"
result <- data %>% dplyr::select(c( independent.var , dependent.var)) %>% dplyr::group_by_(independent.var) %>% dplyr::summarise_all(c(average=mean,min=min,max=max))
sens <- orientation_plot(result, region, 10, 10)
barchart_impact(.data = result, x = region, y = average, infimum_error = min, supremum_error = max, sens.barchart = sens, percent = FALSE)
debug(grouped_barchart_impact)
regions.value=c("capitalcentral","capitalcentral", "north","north","south","south","west","west")
choices_value=c("yes","no","yes","no","yes","no","yes","no")
result_percent= c(0.5,0.50, 0.30, 0.70, 0.45,0.55, 0.90,0.10)
min_value <- result_percent-5
max_value <- result_percent+5
table_result <- data.frame(region=regions.value, choice=choices_value, percents=result_percent, infimum_error=min_value, supremum_error=max_value)
grouped_barchart_impact(table_result, region , choice , percents, infimum_error, supremum_error, sens.barchart="vertical", percent = TRUE, scale.percent = 100 )
x <- enquo(x)
subset.x <- enquo(subset.x)
y <- enquo(y)
infimum_error <- enquo(infimum_error)
supremum_error <- enquo(supremum_error)
debug(error_message_empty_env_barchart)
# Check and return message if empty evironnement
stop_msg <- error_message_empty_env_barchart( x, subset.x, y, infimum_error, supremum_error)
devtools::document()
devtools::load_all()
devtools::build()
devtools::install()
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>"
)
library("visualisationIMPACT")
library(magrittr)
library("ggthemes")
library("rlang")
library(extrafont)
data<-read.csv("../tests/testthat/testdata.csv")
dependent.var = "hhnumberindividuals"
independent.var = "region"
result <- data %>% dplyr::select(c( independent.var , dependent.var)) %>% dplyr::group_by_(independent.var) %>% dplyr::summarise_all(c(average=mean,min=min,max=max))
extrafont::loadfonts(device="win")
sens <- orientation_plot(result, region, 10, 10)
barchart_impact(.data = result, x = region, y = average, infimum_error = min, supremum_error = max, sens.barchart = sens, percent = FALSE)
sens <- orientation_plot(result, region, 10, 10)
barchart_impact(.data = result, x = region, y = average, infimum_error = min, supremum_error = max, sens.barchart = sens, percent = FALSE)
source('~/GitHub/visualisationIMPACT/R/checking_utilities.R')
sens <- orientation_plot(result, region, 10, 10)
barchart_impact(.data = result, x = region, y = average, infimum_error = min, supremum_error = max, sens.barchart = sens, percent = FALSE)
library("visualisationIMPACT")
sens <- orientation_plot(result, region, 10, 10)
barchart_impact(.data = result, x = region, y = average, infimum_error = min, supremum_error = max, sens.barchart = sens, percent = FALSE)
library("visualisationIMPACT")
library(magrittr)
library("ggthemes")
library("rlang")
library(extrafont)
data<-read.csv("../tests/testthat/testdata.csv")
dependent.var = "hhnumberindividuals"
independent.var = "region"
result <- data %>% dplyr::select(c( independent.var , dependent.var)) %>% dplyr::group_by_(independent.var) %>% dplyr::summarise_all(c(average=mean,min=min,max=max))
extrafont::loadfonts(device="win")
sens <- orientation_plot(result, region, 10, 10)
barchart_impact(.data = result, x = region, y = average, infimum_error = min, supremum_error = max, sens.barchart = sens, percent = FALSE)
ggsave(filename = "test.jpg", plot = last_plot(), width = 4, height = 4, units = "cm")
result$average <- c(0.5,0.50, 0.30, 0.70, 0.3, 0.8, 0.1)
barchart_impact(.data = result, x = region, y = average, sens.barchart = "horizontal", percent = TRUE, scale.percent = 100)
regions.value=c("capitalcentral","capitalcentral", "north","north","south","south","west","west")
choices_value=c("yes","no","yes","no","yes","no","yes","no")
result_percent= c(0.5,0.50, 0.30, 0.70, 0.45,0.55, 0.90,0.10)
min_value <- result_percent-5
max_value <- result_percent+5
table_result <- data.frame(region=regions.value, choice=choices_value, percents=result_percent, infimum_error=min_value, supremum_error=max_value)
grouped_barchart_impact(table_result, region , choice , percents, infimum_error, supremum_error, sens.barchart="vertical", percent = TRUE, scale.percent = 100 )
source('~/GitHub/visualisationIMPACT/R/barchart_functions.R')
regions.value=c("capitalcentral","capitalcentral", "north","north","south","south","west","west")
choices_value=c("yes","no","yes","no","yes","no","yes","no")
result_percent= c(0.5,0.50, 0.30, 0.70, 0.45,0.55, 0.90,0.10)
min_value <- result_percent-5
max_value <- result_percent+5
table_result <- data.frame(region=regions.value, choice=choices_value, percents=result_percent, infimum_error=min_value, supremum_error=max_value)
grouped_barchart_impact(table_result, region , choice , percents, infimum_error, supremum_error, sens.barchart="vertical", percent = TRUE, scale.percent = 100 )
source('~/GitHub/visualisationIMPACT/R/impact_style.R')
source('~/GitHub/visualisationIMPACT/R/reach_color.R')
source('~/GitHub/visualisationIMPACT/R/reach_color.R')
source('~/GitHub/visualisationIMPACT/R/checking_utilities.R')
source('~/GitHub/visualisationIMPACT/R/utilities.R')
source('~/GitHub/visualisationIMPACT/R/barchart_functions.R')
regions.value=c("capitalcentral","capitalcentral", "north","north","south","south","west","west")
choices_value=c("yes","no","yes","no","yes","no","yes","no")
result_percent= c(0.5,0.50, 0.30, 0.70, 0.45,0.55, 0.90,0.10)
min_value <- result_percent-5
max_value <- result_percent+5
table_result <- data.frame(region=regions.value, choice=choices_value, percents=result_percent, infimum_error=min_value, supremum_error=max_value)
grouped_barchart_impact(table_result, region , choice , percents, infimum_error, supremum_error, sens.barchart="vertical", percent = TRUE, scale.percent = 100 )
debug(grouped_barchart_impact)
grouped_barchart_impact(table_result, region , choice , percents, infimum_error, supremum_error, sens.barchart="vertical", percent = TRUE, scale.percent = 100 )
x <- enquo(x)
subset.x <- enquo(subset.x)
y <- enquo(y)
infimum_error <- enquo(infimum_error)
supremum_error <- enquo(supremum_error)
# Check and return message if empty evironnement
stop_msg <- error_message_empty_env_barchart( x, subset.x, y, infimum_error, supremum_error)
if(stop_msg != ""){
stop(paste0("The variable(s) following does not exist in .data: ",stop_msg))
}
if(sens.barchart != "vertical" & sens.barchart != "horizontal"){
stop("Please enter a valid value to the parameter sens.barchart: 'vertical' or 'horizontal'")
}
if(percent != TRUE & percent != FALSE){
stop("Please enter a valid value to the parameter percent: TRUE or FALSE")
}
# No percentages > 100
if(percent == TRUE & TRUE %in% (rlang::eval_tidy(y,.data)*scale.percent > 100) ){
stop("One of the percentages given is greater than 100 %. Please enter valid numbers.")
}
#Scale percentages =can be either 1 or 100
if(scale.percent != 1 & scale.percent != 100){
stop("Parameter scale.percent is not value. Has to be egal to 1 or 100")
}
#No plot if y is NA
check_contains_only_NA(x,.data)
check_contains_only_NA(y,.data)
check_contains_only_NA(subset.x,.data)
# Create ggplot
theplot <- ggplot(.data, aes(x = !!x,y = (!!y)*scale.percent, fill = !!subset.x)) + geom_bar_impact() +
theme_impact() + labs( x = NULL, y = NULL) + scale_fill_reach_categorical(n=nrow(dplyr::distinct(.data,!!subset.x)),name="")
coordinate.y.text <- 10
coordinate.y.text <- max( rlang::eval_tidy(!!y,.data)*scale.percent) + 10
rlang::eval_tidy(!!y,.data)
rlang::eval_tidy(y,.data)
source('~/GitHub/visualisationIMPACT/R/barchart_functions.R')
undebug(grouped_barchart_impact)
source('~/GitHub/visualisationIMPACT/R/barchart_functions.R')
regions.value=c("capitalcentral","capitalcentral", "north","north","south","south","west","west")
choices_value=c("yes","no","yes","no","yes","no","yes","no")
result_percent= c(0.5,0.50, 0.30, 0.70, 0.45,0.55, 0.90,0.10)
min_value <- result_percent-5
max_value <- result_percent+5
table_result <- data.frame(region=regions.value, choice=choices_value, percents=result_percent, infimum_error=min_value, supremum_error=max_value)
grouped_barchart_impact(table_result, region , choice , percents, infimum_error, supremum_error, sens.barchart="vertical", percent = TRUE, scale.percent = 100 )
source('~/GitHub/visualisationIMPACT/R/barchart_functions.R')
regions.value=c("capitalcentral","capitalcentral", "north","north","south","south","west","west")
choices_value=c("yes","no","yes","no","yes","no","yes","no")
result_percent= c(0.5,0.50, 0.30, 0.70, 0.45,0.55, 0.90,0.10)
min_value <- result_percent-5
max_value <- result_percent+5
table_result <- data.frame(region=regions.value, choice=choices_value, percents=result_percent, infimum_error=min_value, supremum_error=max_value)
grouped_barchart_impact(table_result, region , choice , percents, infimum_error, supremum_error, sens.barchart="vertical", percent = TRUE, scale.percent = 100 )
source('~/GitHub/visualisationIMPACT/R/barchart_functions.R')
regions.value=c("capitalcentral","capitalcentral", "north","north","south","south","west","west")
choices_value=c("yes","no","yes","no","yes","no","yes","no")
result_percent= c(0.5,0.50, 0.30, 0.70, 0.45,0.55, 0.90,0.10)
min_value <- result_percent-5
max_value <- result_percent+5
table_result <- data.frame(region=regions.value, choice=choices_value, percents=result_percent, infimum_error=min_value, supremum_error=max_value)
grouped_barchart_impact(table_result, region , choice , percents, infimum_error, supremum_error, sens.barchart="vertical", percent = TRUE, scale.percent = 100 )
source('~/GitHub/visualisationIMPACT/R/barchart_functions.R')
regions.value=c("capitalcentral","capitalcentral", "north","north","south","south","west","west")
choices_value=c("yes","no","yes","no","yes","no","yes","no")
result_percent= c(0.5,0.50, 0.30, 0.70, 0.45,0.55, 0.90,0.10)
min_value <- result_percent-5
max_value <- result_percent+5
table_result <- data.frame(region=regions.value, choice=choices_value, percents=result_percent, infimum_error=min_value, supremum_error=max_value)
grouped_barchart_impact(table_result, region , choice , percents, infimum_error, supremum_error, sens.barchart="vertical", percent = TRUE, scale.percent = 100 )
table_result
grouped_barchart_impact(table_result, region , choice , percents, infimum_error, supremum_error, sens.barchart="vertical", percent = TRUE, scale.percent = 100 )
source('~/GitHub/visualisationIMPACT/R/barchart_functions.R')
regions.value=c("capitalcentral","capitalcentral", "north","north","south","south","west","west")
choices_value=c("yes","no","yes","no","yes","no","yes","no")
result_percent= c(0.5,0.50, 0.30, 0.70, 0.45,0.55, 0.90,0.10)
min_value <- result_percent-5
max_value <- result_percent+5
table_result <- data.frame(region=regions.value, choice=choices_value, percents=result_percent, infimum_error=min_value, supremum_error=max_value)
grouped_barchart_impact(table_result, region , choice , percents, infimum_error, supremum_error, sens.barchart="vertical", percent = TRUE, scale.percent = 100 )
regions.value=c("capitalcentral","capitalcentral","capitalcentral","north", "north","north","south","south","south","west","west","west")
choices_value=c("yes","no", "bb","yes","no", "bb","yes","no","bb","yes","no","bb")
result_percent=c(40,50,100,30,200,30,50,70, 20,50, 60, 70 )
min_value <- result_percent - 10
max_value <-result_percent + 20
table_result <- data.frame(region=regions.value, choice=choices_value, percents=result_percent, infimum_error=min_value, supremum_error=max_value)
theplot <- grouped_barchart_impact(table_result, region , choice , percents, infimum_error, supremum_error, sens.barchart="horizontal", percent = FALSE )
theplot + ggplot2::scale_y_continuous(limits=c(-100,100))
regions.value=c("capitalcentral","capitalcentral","capitalcentral","north", "north","north","south","south","south","west","west","west")
choices_value=c("yes","no", "bb","yes","no", "bb","yes","no","bb","yes","no","bb")
result_percent=c(40,50,100,30,200,30,50,70, 20,50, 60, 70 )
min_value <- result_percent - 10
max_value <-result_percent + 20
table_result <- data.frame(region=regions.value, choice=choices_value, percents=result_percent, infimum_error=min_value, supremum_error=max_value)
grouped_barchart_impact(table_result, region , choice , percents, infimum_error, supremum_error, sens.barchart="horizontal", percent = FALSE )
source('~/GitHub/visualisationIMPACT/R/barchart_functions.R')
regions.value=c("capitalcentral","capitalcentral","capitalcentral","north", "north","north","south","south","south","west","west","west")
choices_value=c("yes","no", "bb","yes","no", "bb","yes","no","bb","yes","no","bb")
result_percent=c(40,50,100,30,200,30,50,70, 20,50, 60, 70 )
min_value <- result_percent - 10
max_value <-result_percent + 20
table_result <- data.frame(region=regions.value, choice=choices_value, percents=result_percent, infimum_error=min_value, supremum_error=max_value)
grouped_barchart_impact(table_result, region , choice , percents, infimum_error, supremum_error, sens.barchart="horizontal", percent = FALSE )
source('~/GitHub/visualisationIMPACT/R/barchart_functions.R')
source('~/GitHub/visualisationIMPACT/R/barchart_functions.R')
source('~/GitHub/visualisationIMPACT/R/barchart_functions.R')
source('~/GitHub/visualisationIMPACT/R/barchart_functions.R')
source('~/GitHub/visualisationIMPACT/R/utilities.R')
source('~/GitHub/visualisationIMPACT/R/barchart_functions.R')
source('~/GitHub/visualisationIMPACT/R/barchart_functions.R')
regions.value=c("capitalcentral","capitalcentral","capitalcentral","north", "north","north","south","south","south","west","west","west")
choices_value=c("yes","no", "bb","yes","no", "bb","yes","no","bb","yes","no","bb")
result_percent=c(40,50,100,30,200,30,50,70, 20,50, 60, 70 )
min_value <- result_percent - 10
max_value <-result_percent + 20
table_result <- data.frame(region=regions.value, choice=choices_value, percents=result_percent, infimum_error=min_value, supremum_error=max_value)
grouped_barchart_impact(table_result, region , choice , percents, infimum_error, supremum_error, sens.barchart="horizontal", percent = FALSE )
source('~/GitHub/visualisationIMPACT/R/barchart_functions.R')
source('~/GitHub/visualisationIMPACT/R/barchart_functions.R')
source('~/GitHub/visualisationIMPACT/R/utilities.R')
regions.value=c("capitalcentral","capitalcentral","capitalcentral","north", "north","north","south","south","south","west","west","west")
choices_value=c("yes","no", "bb","yes","no", "bb","yes","no","bb","yes","no","bb")
result_percent=c(40,50,100,30,200,30,50,70, 20,50, 60, 70 )
min_value <- result_percent - 10
max_value <-result_percent + 20
table_result <- data.frame(region=regions.value, choice=choices_value, percents=result_percent, infimum_error=min_value, supremum_error=max_value)
grouped_barchart_impact(table_result, region , choice , percents, infimum_error, supremum_error, sens.barchart="horizontal", percent = FALSE )
source('~/GitHub/visualisationIMPACT/R/utilities.R')
regions.value=c("capitalcentral","capitalcentral","capitalcentral","north", "north","north","south","south","south","west","west","west")
choices_value=c("yes","no", "bb","yes","no", "bb","yes","no","bb","yes","no","bb")
result_percent=c(40,50,100,30,200,30,50,70, 20,50, 60, 70 )
min_value <- result_percent - 10
max_value <-result_percent + 20
table_result <- data.frame(region=regions.value, choice=choices_value, percents=result_percent, infimum_error=min_value, supremum_error=max_value)
grouped_barchart_impact(table_result, region , choice , percents, infimum_error, supremum_error, sens.barchart="horizontal", percent = FALSE )
regions.value=c("capitalcentral","capitalcentral", "north","north","south","south","west","west")
choices_value=c("yes","no","yes","no","yes","no","yes","no")
result_percent= c(0.5,0.50, 0.30, 0.70, 0.45,0.55, 0.90,0.10)
min_value <- result_percent-5
max_value <- result_percent+5
table_result <- data.frame(region=regions.value, choice=choices_value, percents=result_percent, infimum_error=min_value, supremum_error=max_value)
grouped_barchart_impact(table_result, region , choice , percents, infimum_error, supremum_error, sens.barchart="vertical", percent = TRUE, scale.percent = 100 )
result$average <- c(0.5,0.50, 0.30, 0.70, 0.3, 0.8, 0.1)
barchart_impact(.data = result, x = region, y = average, sens.barchart = "horizontal", percent = TRUE, scale.percent = 100)
sens <- orientation_plot(result, region, 10, 10)
barchart_impact(.data = result, x = region, y = average, infimum_error = min, supremum_error = max, sens.barchart = sens, percent = FALSE)
ggsave(filename = "test.jpg", plot = last_plot(), width = 4, height = 4, units = "cm")
sens <- orientation_plot(result, region, 10, 10)
barchart_impact(.data = result, x = region, y = average, infimum_error = min, supremum_error = max, sens.barchart = sens, percent = FALSE)
ggsave(filename = "test.jpg", plot = last_plot(), width = 4, height = 4, units = "cm")
dependent.var = "hhnumberindividuals"
independent.var = "region"
result <- data %>% dplyr::select(c( independent.var , dependent.var)) %>% dplyr::group_by_(independent.var) %>% dplyr::summarise_all(c(average=mean,min=min,max=max))
extrafont::loadfonts(device="win")
sens <- orientation_plot(result, region, 10, 10)
barchart_impact(.data = result, x = region, y = average, infimum_error = min, supremum_error = max, sens.barchart = sens, percent = FALSE)
ggsave(filename = "test.jpg", plot = last_plot(), width = 4, height = 4, units = "cm")
barchart_impact(.data = result, x = region, y = average, infimum_error = min, supremum_error = max, sens.barchart = "horizontal", percent = FALSE)
source('~/GitHub/visualisationIMPACT/R/barchart_functions.R')
source('~/GitHub/visualisationIMPACT/R/barchart_functions.R')
source('~/GitHub/visualisationIMPACT/R/barchart_functions.R')
source('~/GitHub/visualisationIMPACT/R/barchart_functions.R')
result$average <- c(0.5,0.50, 0.30, 0.70, 0.3, 0.8, 0.1)
barchart_impact(.data = result, x = region, y = average, sens.barchart = "horizontal", percent = TRUE, scale.percent = 100)
result$average <- c(200, 50,40,30, 10,5,40)
testthat::expect_error(barchart_impact(.data = result, x = region, y = average, infimum_error = min, supremum_error = max, sens.barchart = sens, percent = TRUE, scale.percent = 100))
regions.value=c("capitalcentral","capitalcentral", "north","north","south","south","west","west")
choices_value=c("yes","no","yes","no","yes","no","yes","no")
result_percent= c(0.5,0.50, 0.30, 0.70, 0.45,0.55, 0.90,0.10)
min_value <- result_percent-5
max_value <- result_percent+5
table_result <- data.frame(region=regions.value, choice=choices_value, percents=result_percent, infimum_error=min_value, supremum_error=max_value)
grouped_barchart_impact(table_result, region , choice , percents, infimum_error, supremum_error, sens.barchart="vertical", percent = TRUE, scale.percent = 100 )
source('~/GitHub/visualisationIMPACT/R/barchart_functions.R')
regions.value=c("capitalcentral","capitalcentral", "north","north","south","south","west","west")
choices_value=c("yes","no","yes","no","yes","no","yes","no")
result_percent= c(0.5,0.50, 0.30, 0.70, 0.45,0.55, 0.90,0.10)
min_value <- result_percent-5
max_value <- result_percent+5
table_result <- data.frame(region=regions.value, choice=choices_value, percents=result_percent, infimum_error=min_value, supremum_error=max_value)
grouped_barchart_impact(table_result, region , choice , percents, infimum_error, supremum_error, sens.barchart="vertical", percent = TRUE, scale.percent = 100 )
debug(grouped_barchart_impact)
grouped_barchart_impact(table_result, region , choice , percents, infimum_error, supremum_error, sens.barchart="vertical", percent = TRUE, scale.percent = 100 )
x <- enquo(x)
subset.x <- enquo(subset.x)
y <- enquo(y)
infimum_error <- enquo(infimum_error)
supremum_error <- enquo(supremum_error)
# Check and return message if empty evironnement
stop_msg <- error_message_empty_env_barchart( x, subset.x, y, infimum_error, supremum_error)
if(stop_msg != ""){
stop(paste0("The variable(s) following does not exist in .data: ",stop_msg))
}
if(sens.barchart != "vertical" & sens.barchart != "horizontal"){
stop("Please enter a valid value to the parameter sens.barchart: 'vertical' or 'horizontal'")
}
if(percent != TRUE & percent != FALSE){
stop("Please enter a valid value to the parameter percent: TRUE or FALSE")
}
# No percentages > 100
if(percent == TRUE & TRUE %in% (rlang::eval_tidy(y,.data)*scale.percent > 100) ){
stop("One of the percentages given is greater than 100 %. Please enter valid numbers.")
}
#Scale percentages =can be either 1 or 100
if(scale.percent != 1 & scale.percent != 100){
stop("Parameter scale.percent is not value. Has to be egal to 1 or 100")
}
#No plot if y is NA
check_contains_only_NA(x,.data)
check_contains_only_NA(y,.data)
check_contains_only_NA(subset.x,.data)
# Create ggplot
theplot <- ggplot(.data, aes(x = !!x,y = (!!y)*scale.percent, fill = !!subset.x)) + geom_bar_impact() +
theme_impact() + labs( x = NULL, y = NULL) + scale_fill_reach_categorical(n=nrow(dplyr::distinct(.data,!!subset.x)),name="")
# Add value to the plot
theplot <- add_stat_to_barchart(theplot, .data , x , y , supremum_error, scale.percent, percent)
# Add values
if (rlang::quo_is_null(infimum_error) | rlang::quo_is_null(supremum_error)) {
warning("Could not find the min or max column. No error bars will be added to the barchart")
}
# Add error bar to the plot
infimum_error_without_negative <- check_and_replace_negative_value(.data, infimum_error)
View(infimum_error_without_negative)
infimum_error
result_percent= c(0.5,0.50, 0.30, 0.70, 0.45,0.55, 0.90,0.10)
eval_tidy(infimum_error, .data)
eval_tidy(infimum_error, .data) * scale.percent
scale.percent <- 1
eval_tidy(infimum_error, .data) * scale.percent
# Add error bar to the plot
infimum_error_without_negative <- check_and_replace_negative_value(.data, infimum_error)
infimum_error_without_negative
theplot <- theplot + geom_errorbar_impact( aes(x=!!x,
ymin = as.numeric(infimum_error_without_negative * scale.percent),
ymax = as.numeric(supremum_error_without_negative * scale.percent) ))
as.numeric(infimum_error_without_negative * scale.percent)
as.numeric(infimum_error_without_negative)
as.numeric(infimum_error_without_negative) * scale.percent
source('~/GitHub/visualisationIMPACT/R/barchart_functions.R')
regions.value=c("capitalcentral","capitalcentral", "north","north","south","south","west","west")
choices_value=c("yes","no","yes","no","yes","no","yes","no")
result_percent= c(0.5,0.50, 0.30, 0.70, 0.45,0.55, 0.90,0.10)
min_value <- result_percent-5
max_value <- result_percent+5
table_result <- data.frame(region=regions.value, choice=choices_value, percents=result_percent, infimum_error=min_value, supremum_error=max_value)
grouped_barchart_impact(table_result, region , choice , percents, infimum_error, supremum_error, sens.barchart="vertical", percent = TRUE, scale.percent = 1 )
grouped_barchart_impact(table_result, region , choice , percents, infimum_error, supremum_error, sens.barchart="vertical", percent = TRUE, scale.percent = 1 ) + scale_y_continuous(limits = c(0,25))
source('~/GitHub/visualisationIMPACT/R/utilities.R')
source('~/GitHub/visualisationIMPACT/R/utilities.R')
source('~/GitHub/visualisationIMPACT/R/utilities.R')
regions.value=c("capitalcentral","capitalcentral", "north","north","south","south","west","west")
choices_value=c("yes","no","yes","no","yes","no","yes","no")
result_percent= c(0.5,0.50, 0.30, 0.70, 0.45,0.55, 0.90,0.10)
min_value <- result_percent-5
max_value <- result_percent+5
table_result <- data.frame(region=regions.value, choice=choices_value, percents=result_percent, infimum_error=min_value, supremum_error=max_value)
grouped_barchart_impact(table_result, region , choice , percents, infimum_error, supremum_error, sens.barchart="vertical", percent = TRUE, scale.percent = 1 ) + scale_y_continuous(limits = c(0,25))
grouped_barchart_impact(table_result, region , choice , percents, infimum_error, supremum_error, sens.barchart="vertical", percent = TRUE, scale.percent = 1 ) + scale_y_continuous(limits = c(0,15))
grouped_barchart_impact(table_result, region , choice , percents, infimum_error, supremum_error, sens.barchart="vertical", percent = TRUE, scale.percent = 1 ) + scale_y_continuous(limits = c(0,10))
grouped_barchart_impact(table_result, region , choice , percents, infimum_error, supremum_error, sens.barchart="vertical", percent = TRUE, scale.percent = 1 ) + scale_y_continuous(limits = c(0,7))
regions.value=c("capitalcentral","capitalcentral","capitalcentral","north", "north","north","south","south","south","west","west","west")
choices_value=c("yes","no", "bb","yes","no", "bb","yes","no","bb","yes","no","bb")
result_percent=c(40,50,100,30,200,30,50,70, 20,50, 60, 70 )
min_value <- result_percent - 10
max_value <-result_percent + 20
table_result <- data.frame(region=regions.value, choice=choices_value, percents=result_percent, infimum_error=min_value, supremum_error=max_value)
grouped_barchart_impact(table_result, region , choice , percents, infimum_error, supremum_error, sens.barchart="horizontal", percent = FALSE )
theplot <-grouped_barchart_impact(table_result, region , choice , percents, infimum_error, supremum_error, sens.barchart="horizontal", percent = FALSE )
theplot$layers
theplot$mapping
theplot$scales
theplot$coordinates
theplot$coordinates$limits
theplot$coordinates$range
theplot$coordinates$setup_layout
theplot$coordinates$render_axis_v
theplot$coordinates$render_axis_h
theplot$coordinates$default
theplot$coordinates$setup_panel_params
theplot$coordinates$modify_scales
theplot$facet
theplot$facet$train_scales
theplot$facet$params
View(theplot)
View(theplot)
regions.value=c("capitalcentral","capitalcentral", "north","north","south","south","west","west")
choices_value=c("yes","no","yes","no","yes","no","yes","no")
result_percent= c(0.5,0.50, 0.30, 0.70, 0.45,0.55, 0.90,0.10)
min_value <- result_percent-5
max_value <- result_percent+5
table_result <- data.frame(region=regions.value, choice=choices_value, percents=result_percent, infimum_error=min_value, supremum_error=max_value)
grouped_barchart_impact(table_result, region , choice , percents, infimum_error, supremum_error, sens.barchart="vertical", percent = TRUE, scale.percent = 1 ) + scale_y_continuous(limits = c(0,7))
regions.value=c("capitalcentral","capitalcentral","capitalcentral","north", "north","north","south","south","south","west","west","west")
choices_value=c("yes","no", "bb","yes","no", "bb","yes","no","bb","yes","no","bb")
result_percent=c(40,50,100,30,200,30,50,70, 20,50, 60, 70 )
min_value <- result_percent - 10
max_value <-result_percent + 20
table_result <- data.frame(region=regions.value, choice=choices_value, percents=result_percent, infimum_error=min_value, supremum_error=max_value)
theplot <-grouped_barchart_impact(table_result, region , choice , percents, infimum_error, supremum_error, sens.barchart="horizontal", percent = FALSE )
